(ID "OR")
(PUNCT "=")
(LIT "OR")
(NEWLINE)
(ID "CASE_SENSITIVE")
(PUNCT "=")
(LIT "Sensitive")
(NEWLINE)
(ID "SCRIPT_PAT")
(PUNCT "=")
(PUNCT "[")
(LIT "<")
(PUNCT ",")
(LIT "s")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "r")
(PUNCT ",")
(LIT "i")
(PUNCT ",")
(LIT "p")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT ">")
(PUNCT "]")
(NEWLINE)
(KEYWORD def)
(ID "lst_to_str")
(PUNCT "(")
(ID "lst")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "l")
(PUNCT "=")
(ID "len")
(PUNCT "(")
(ID "lst")
(PUNCT ")")
(NEWLINE)
(ID "i")
(PUNCT "=")
(LIT 0)
(NEWLINE)
(ID "res_str")
(PUNCT "=")
(LIT "")
(NEWLINE)
(KEYWORD while)
(PUNCT "(")
(ID "i")
(PUNCT "<")
(ID "l")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "res_str")
(PUNCT "=")
(ID "res_str")
(PUNCT "+")
(ID "lst")
(PUNCT "[")
(ID "i")
(PUNCT "]")
(NEWLINE)
(ID "i")
(PUNCT "=")
(ID "i")
(PUNCT "+")
(LIT 1)
(NEWLINE)
(DEDENT)
(KEYWORD return)
(ID "res_str")
(NEWLINE)
(DEDENT)
(KEYWORD def)
(ID "issubstring")
(PUNCT "(")
(ID "s")
(PUNCT ",")
(ID "p")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "i")
(PUNCT "=")
(LIT 0)
(NEWLINE)
(KEYWORD while)
(ID "i")
(PUNCT "<=")
(ID "len")
(PUNCT "(")
(ID "s")
(PUNCT ")")
(PUNCT "-")
(ID "len")
(PUNCT "(")
(ID "p")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "j")
(PUNCT "=")
(ID "i")
(NEWLINE)
(KEYWORD for)
(ID "c")
(KEYWORD in)
(ID "p")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD if)
(ID "c")
(PUNCT "!=")
(ID "s")
(PUNCT "[")
(ID "j")
(PUNCT "]")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD break)
(NEWLINE)
(DEDENT)
(KEYWORD else)
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "j")
(PUNCT "=")
(ID "j")
(PUNCT "+")
(LIT 1)
(NEWLINE)
(KEYWORD if)
(ID "j")
(PUNCT "-")
(ID "i")
(PUNCT "==")
(ID "len")
(PUNCT "(")
(ID "p")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(KEYWORD True)
(NEWLINE)
(DEDENT)
(DEDENT)
(DEDENT)
(ID "i")
(PUNCT "=")
(ID "i")
(PUNCT "+")
(LIT 1)
(NEWLINE)
(DEDENT)
(KEYWORD return)
(KEYWORD False)
(NEWLINE)
(DEDENT)
(KEYWORD def)
(ID "santinize_proc")
(PUNCT "(")
(ID "lst")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(ID "issubstring")
(PUNCT "(")
(ID "lst")
(PUNCT ",")
(ID "SCRIPT_PAT")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD def)
(ID "proc_results")
(PUNCT "(")
(ID "terms")
(PUNCT ",")
(ID "results")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "is_valid")
(PUNCT "=")
(ID "santinize_proc")
(PUNCT "(")
(ID "terms")
(PUNCT ")")
(NEWLINE)
(KEYWORD if)
(ID "is_valid")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "print")
(PUNCT "(")
(LIT "failed because of script")
(PUNCT ")")
(NEWLINE)
(KEYWORD return)
(PUNCT "-")
(LIT 1)
(NEWLINE)
(DEDENT)
(ID "print")
(PUNCT "(")
(LIT "<div id= \"search_results\">\n<ol>)")
(PUNCT ")")
(NEWLINE)
(ID "l")
(PUNCT "=")
(ID "len")
(PUNCT "(")
(ID "results")
(PUNCT ")")
(NEWLINE)
(KEYWORD if)
(ID "l")
(PUNCT "==")
(LIT 0)
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "print")
(PUNCT "(")
(LIT "<h3>Your search did not return any results.</h3>")
(PUNCT "+")
(ID "lst_to_str")
(PUNCT "(")
(ID "terms")
(PUNCT ")")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(ID "indx")
(PUNCT "=")
(LIT 0)
(NEWLINE)
(KEYWORD while)
(ID "indx")
(PUNCT "<")
(ID "l")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "print")
(PUNCT "(")
(LIT "<li <a href=\"test/")
(PUNCT "+")
(ID "results")
(PUNCT "[")
(ID "indx")
(PUNCT "]")
(PUNCT "[")
(LIT 1)
(PUNCT "]")
(PUNCT "+")
(LIT "?search=true&term=")
(PUNCT "+")
(ID "lst_to_str")
(PUNCT "(")
(ID "terms")
(PUNCT ")")
(PUNCT "+")
(LIT "\">")
(PUNCT ")")
(NEWLINE)
(ID "print")
(PUNCT "(")
(ID "results")
(PUNCT "[")
(ID "indx")
(PUNCT "]")
(PUNCT "[")
(LIT 0)
(PUNCT "]")
(PUNCT "+")
(LIT "</a>\n")
(PUNCT ")")
(NEWLINE)
(ID "indx")
(PUNCT "=")
(ID "indx")
(PUNCT "+")
(LIT 1)
(NEWLINE)
(DEDENT)
(ID "print")
(PUNCT "(")
(LIT "</ol>\n</div>\n")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD def)
(ID "test_init_input")
(PUNCT "(")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "simulated_cgi_entry1")
(PUNCT "=")
(PUNCT "{")
(LIT "terms")
(PUNCT ":")
(PUNCT "[")
(LIT "red")
(PUNCT ",")
(LIT "blue")
(PUNCT ",")
(LIT "three")
(PUNCT "]")
(PUNCT ",")
(LIT "boolean")
(PUNCT ":")
(ID "OR")
(PUNCT ",")
(LIT "case")
(PUNCT ":")
(ID "CASE_SENSITIVE")
(PUNCT ",")
(LIT "files")
(PUNCT ":")
(PUNCT "[")
(LIT "colors.html")
(PUNCT ",")
(LIT "numbers.html")
(PUNCT ",")
(LIT "numbersandcolors.html")
(PUNCT ",")
(LIT "numbersandcolorswithtag.html")
(PUNCT "]")
(PUNCT "}")
(NEWLINE)
(ID "res")
(PUNCT "=")
(PUNCT "[")
(PUNCT "(")
(LIT "Colors")
(PUNCT ",")
(LIT "colors.html")
(PUNCT ")")
(PUNCT ",")
(PUNCT "(")
(LIT "Numbers")
(PUNCT ",")
(LIT "numbers.html")
(PUNCT ")")
(PUNCT ",")
(PUNCT "(")
(LIT "Numbers and Colors")
(PUNCT ",")
(LIT "numbersandcolors.html")
(PUNCT ")")
(PUNCT ",")
(PUNCT "(")
(LIT "Numbers and Colors With Tag")
(PUNCT ",")
(LIT "numbersandcolorswithtag.html")
(PUNCT ")")
(PUNCT "]")
(NEWLINE)
(KEYWORD return)
(PUNCT "(")
(ID "simulated_cgi_entry1")
(PUNCT "[")
(LIT "terms")
(PUNCT "]")
(PUNCT ",")
(ID "res")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD def)
(ID "default_mal_strlst")
(PUNCT "(")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(PUNCT "[")
(LIT "r")
(PUNCT ",")
(LIT "e")
(PUNCT ",")
(LIT "d")
(PUNCT ",")
(LIT " ")
(PUNCT ",")
(LIT "b")
(PUNCT ",")
(LIT "l")
(PUNCT ",")
(LIT "u")
(PUNCT ",")
(LIT "e")
(PUNCT ",")
(LIT " ")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT "h")
(PUNCT ",")
(LIT "r")
(PUNCT ",")
(LIT "e")
(PUNCT ",")
(LIT "e")
(PUNCT ",")
(LIT " ")
(PUNCT ",")
(LIT "h")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT "p")
(PUNCT ",")
(LIT ":")
(PUNCT ",")
(LIT "/")
(PUNCT ",")
(LIT "/")
(PUNCT ",")
(LIT "v")
(PUNCT ",")
(LIT "i")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT "i")
(PUNCT ",")
(LIT "m")
(PUNCT ",")
(LIT ".")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "o")
(PUNCT ",")
(LIT "m")
(PUNCT ",")
(LIT "/")
(PUNCT ",")
(LIT "p")
(PUNCT ",")
(LIT "o")
(PUNCT ",")
(LIT "s")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT ".")
(PUNCT ",")
(LIT "p")
(PUNCT ",")
(LIT "h")
(PUNCT ",")
(LIT "p")
(PUNCT ",")
(LIT "?")
(PUNCT ",")
(LIT "s")
(PUNCT ",")
(LIT "=")
(PUNCT ",")
(LIT "<")
(PUNCT ",")
(LIT "s")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "r")
(PUNCT ",")
(LIT "i")
(PUNCT ",")
(LIT "p")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT ">")
(PUNCT ",")
(LIT "d")
(PUNCT ",")
(LIT "o")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "u")
(PUNCT ",")
(LIT "m")
(PUNCT ",")
(LIT "e")
(PUNCT ",")
(LIT "n")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT ".")
(PUNCT ",")
(LIT "l")
(PUNCT ",")
(LIT "o")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "a")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT "i")
(PUNCT ",")
(LIT "o")
(PUNCT ",")
(LIT "n")
(PUNCT ",")
(LIT "=")
(PUNCT ",")
(LIT "'")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT "r")
(PUNCT ",")
(LIT "u")
(PUNCT ",")
(LIT "d")
(PUNCT ",")
(LIT "y")
(PUNCT ",")
(LIT "s")
(PUNCT ",")
(LIT "e")
(PUNCT ",")
(LIT "r")
(PUNCT ",")
(LIT "v")
(PUNCT ",")
(LIT "e")
(PUNCT ",")
(LIT "r")
(PUNCT ",")
(LIT ".")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "o")
(PUNCT ",")
(LIT "m")
(PUNCT ",")
(LIT "/")
(PUNCT ",")
(LIT "b")
(PUNCT ",")
(LIT "a")
(PUNCT ",")
(LIT "d")
(PUNCT ",")
(LIT ".")
(PUNCT ",")
(LIT "p")
(PUNCT ",")
(LIT "h")
(PUNCT ",")
(LIT "p")
(PUNCT ",")
(LIT "?")
(PUNCT ",")
(LIT "'")
(PUNCT ",")
(LIT " ")
(PUNCT ",")
(LIT "+")
(PUNCT ",")
(LIT " ")
(PUNCT ",")
(LIT "d")
(PUNCT ",")
(LIT "o")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "u")
(PUNCT ",")
(LIT "m")
(PUNCT ",")
(LIT "e")
(PUNCT ",")
(LIT "n")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT ".")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "o")
(PUNCT ",")
(LIT "o")
(PUNCT ",")
(LIT "k")
(PUNCT ",")
(LIT "i")
(PUNCT ",")
(LIT "e")
(PUNCT ",")
(LIT "<")
(PUNCT ",")
(LIT "/")
(PUNCT ",")
(LIT "s")
(PUNCT ",")
(LIT "c")
(PUNCT ",")
(LIT "i")
(PUNCT ",")
(LIT "p")
(PUNCT ",")
(LIT "t")
(PUNCT ",")
(LIT ">")
(PUNCT "]")
(NEWLINE)
(DEDENT)
(KEYWORD def)
(ID "gen_malicious_input")
(PUNCT "(")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "simulated_cgi_entry2")
(PUNCT "=")
(PUNCT "{")
(LIT "terms")
(PUNCT ":")
(ID "default_mal_strlst")
(PUNCT "(")
(PUNCT ")")
(PUNCT "}")
(NEWLINE)
(ID "res")
(PUNCT "=")
(PUNCT "[")
(PUNCT "]")
(NEWLINE)
(KEYWORD return)
(PUNCT "(")
(ID "simulated_cgi_entry2")
(PUNCT "[")
(LIT "terms")
(PUNCT "]")
(PUNCT ",")
(ID "res")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(ID "test1")
(PUNCT "=")
(ID "test_init_input")
(PUNCT "(")
(PUNCT ")")
(NEWLINE)
(ID "input1")
(PUNCT "=")
(ID "test1")
(PUNCT "[")
(LIT 0)
(PUNCT "]")
(NEWLINE)
(ID "input2")
(PUNCT "=")
(ID "test1")
(PUNCT "[")
(LIT 1)
(PUNCT "]")
(NEWLINE)
(ID "proc_results")
(PUNCT "(")
(ID "input1")
(PUNCT ",")
(ID "input2")
(PUNCT ")")
(NEWLINE)
(ID "print")
(PUNCT "(")
(LIT "-------------------------------")
(PUNCT ")")
(NEWLINE)
(ID "test2")
(PUNCT "=")
(ID "gen_malicious_input")
(PUNCT "(")
(PUNCT ")")
(NEWLINE)
(ID "input3")
(PUNCT "=")
(ID "test2")
(PUNCT "[")
(LIT 0)
(PUNCT "]")
(NEWLINE)
(ID "input4")
(PUNCT "=")
(ID "test2")
(PUNCT "[")
(LIT 1)
(PUNCT "]")
(NEWLINE)
(ID "proc_results")
(PUNCT "(")
(ID "input3")
(PUNCT ",")
(ID "input4")
(PUNCT ")")
(NEWLINE)
(ENDMARKER)
